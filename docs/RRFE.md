#### RRFE (RR-Feature extraction)
This algorithm evaluates each possible combination of contrasts (generated by PCA) and applies seeded knn per contrast to identify the best contrast which achieved the highest classification accuracy. Then the resulted contrast is resulted and the most important features are extracted (based on this contrast).

An example using the diamonds dataset, trying to estimate the best features for the "cut" labels (column 2)
```
RRFE(dataset = as.data.frame(diamonds),f_dataset_class_column_id = 2)
```

Results in:
```
#--------------------------------------------#
Found Class column ID: 2
Using classes: Fair, Good, Very Good, Premium, Ideal
#--------------------------------------------#
min relative feature coefficient set to: 
0.5150963997314
#--------------------------------------------#
Table features selected: 
0.9412236 0.2631052 0.3140789 0.9024616
#--------------------------------------------#
Names features selected: 
table depth
#--------------------------------------------#
$PCA
Standard deviations (1, .., p=9):
[1] 3.989440e+03 2.304355e+00 1.698839e+00 1.690859e+00 1.293056e+00 6.370511e-01 1.925974e-01 1.238488e-01
[9] 7.254783e-02

Rotation (n x k) = (9 x 9):
                  PC1           PC2           PC3           PC4           PC5           PC6           PC7
carat    1.095002e-04 -0.0191043607  0.0611817111 -4.751793e-02  1.373861e-02  0.1408823567 -1.433635e-01
color    7.355901e-05  0.0044075973  0.9175112313  3.510830e-01  9.567310e-02 -0.1590642047  1.113495e-02
clarity -6.060996e-05  0.1921769919 -0.2528568815  8.638525e-01 -2.493641e-01  0.2997344813 -2.026207e-02
depth   -3.823522e-06  0.2631051579  0.2000290512 -2.691016e-01 -9.024616e-01  0.0258897923  3.222389e-02
table    7.120789e-05 -0.9412235664 -0.0128883303  1.219171e-01 -3.140789e-01 -0.0194091224  5.201631e-03
price    9.999999e-01  0.0001142357 -0.0001735729  9.927302e-05 -4.801697e-05 -0.0003387389  2.724333e-05
x        2.486877e-04 -0.0611524703  0.1421336457 -1.272438e-01  8.327274e-02  0.5524784017 -4.854739e-01
y        2.477609e-04 -0.0581850767  0.1424656621 -1.263902e-01  9.195955e-02  0.6504358888  7.211870e-01
z        1.523479e-04 -0.0207926278  0.0990814693 -9.379120e-02 -1.428042e-03  0.3683254555 -4.712233e-01
                  PC8           PC9
carat    2.245047e-01  9.500746e-01
color   -8.683937e-03 -1.550101e-02
clarity  1.399119e-02  1.614906e-02
depth    4.363430e-02 -1.728710e-02
table   -3.100158e-03 -3.061412e-03
price   -2.016051e-05 -3.701525e-05
x        5.640273e-01 -3.064129e-01
y       -9.192495e-02  1.610127e-02
z       -7.879314e-01  4.899735e-02

$RawScoring
   V1 V2        V3        V4        V5        V6        V7        V8        V9       V10       V11
1   2  1 0.7566926 0.6210604 0.6278828 0.7410456 0.7345940 0.7308120 0.6234334 0.7391917 0.6278828
2   3  1 0.7566926 0.6210604 0.6278828 0.7410456 0.7345940 0.7308120 0.6234334 0.7391917 0.6278828
3   3  2 0.4219503 0.5286615 0.7001112 0.7282907 0.6907675 0.7000742 0.5668150 0.3720059 0.7484613
4   4  1 0.7566926 0.6210604 0.6278828 0.7410456 0.7345940 0.7308120 0.6234334 0.7391917 0.6278828
5   4  2 0.3731554 0.3139414 0.7261031 0.5835002 0.6823878 0.7418984 0.5836485 0.3336670 0.3139414
6   4  3 0.5768261 0.6387097 0.5640341 0.5885428 0.6191694 0.5769003 0.5388209 0.6546904 0.5607712
7   5  1 0.7566926 0.6210604 0.6278828 0.7410456 0.7345940 0.7308120 0.6234334 0.7391917 0.6278828
8   5  2 0.8300334 0.7839080 0.7818317 0.7636263 0.6974787 0.7479422 0.6060808 0.3154245 0.6004079
9   5  3 0.6830182 0.7781980 0.6008899 0.7339266 0.7342603 0.4977753 0.6012607 0.7515758 0.7245458
10  5  4 0.7382647 0.7516500 0.7336670 0.7270300 0.6977753 0.5135706 0.4672970 0.7563218 0.7336670
11  6  1 0.7566926 0.6210604 0.6278828 0.7410456 0.7345940 0.7308120 0.6234334 0.7391917 0.6278828
12  6  2 0.2539488 0.3656285 0.7823137 0.5855766 0.7281424 0.8011494 0.5633667 0.3590286 0.3656285
13  6  3 0.5961439 0.6765666 0.5509455 0.6435298 0.6784205 0.6273267 0.5649981 0.6687060 0.6204301
14  6  4 0.6082314 0.5779385 0.6022247 0.6079718 0.5823137 0.5301817 0.6255840 0.6154616 0.5600667
15  6  5 0.6408973 0.7108639 0.6968113 0.6408973 0.6805710 0.5501669 0.4251020 0.6489062 0.7535410
16  7  1 0.7566926 0.6210604 0.6278828 0.7410456 0.7345940 0.7308120 0.6234334 0.7391917 0.6278828
17  7  2 0.2518354 0.3650352 0.7827215 0.5694105 0.7175751 0.8011123 0.5693734 0.3582499 0.3635892
18  7  3 0.5971079 0.6763441 0.5909529 0.6664442 0.6664442 0.6287356 0.5751947 0.6654802 0.6664442
19  7  4 0.5315165 0.5182054 0.5929922 0.6182054 0.5838339 0.5182054 0.5985539 0.6397479 0.5199852
20  7  5 0.6814609 0.7110122 0.6727475 0.6814609 0.7121617 0.6267705 0.4803856 0.6354468 0.7551353
21  7  6 0.6018539 0.6513904 0.6931034 0.5221357 0.6972933 0.6342232 0.6345198 0.4984056 0.6714498
22  8  1 0.7566926 0.6210604 0.6278828 0.7410456 0.7345940 0.7308120 0.6234334 0.7391917 0.6278828
23  8  2 0.2515758 0.3651094 0.7827586 0.5694105 0.7277345 0.8010753 0.5694105 0.3582499 0.3635892
24  8  3 0.5971450 0.6763441 0.5909529 0.6664442 0.6664442 0.6287356 0.5751947 0.6654802 0.6664442
25  8  4 0.5314794 0.5181683 0.5929181 0.6182054 0.5838710 0.5181683 0.5985539 0.6397849 0.5199852
26  8  5 0.6815721 0.7109752 0.6728217 0.6815721 0.7119021 0.6267334 0.4804968 0.6352243 0.7551724
27  8  6 0.6019281 0.6515017 0.6931034 0.5220245 0.6969596 0.6345198 0.6347794 0.4980719 0.6715981
28  8  7 0.7846867 0.6512421 0.8427141 0.6691138 0.7458658 0.5937338 0.7648869 0.6483871 0.7912125
29  9  1 0.7566926 0.6210604 0.6278828 0.7410456 0.7345940 0.7308120 0.6234334 0.7391917 0.6278828
30  9  2 0.2517983 0.3651835 0.7827586 0.5693734 0.7194661 0.8011123 0.5693734 0.3582499 0.3635892
31  9  3 0.5971450 0.6763441 0.5909900 0.6664071 0.6664071 0.6287356 0.5751947 0.6654802 0.6664071
32  9  4 0.5315165 0.5182054 0.5928439 0.6180942 0.5837968 0.5182054 0.5985169 0.6398591 0.5201335
33  9  5 0.6815721 0.7108639 0.6728587 0.6815721 0.7120133 0.6267705 0.4804968 0.6352985 0.7550983
34  9  6 0.6018539 0.6512050 0.6932888 0.5215054 0.6969596 0.6345569 0.6348535 0.4976270 0.6718576
35  9  7 0.8311828 0.4879496 0.7000000 0.7581387 0.5541342 0.8011865 0.8294772 0.5807564 0.4823137
36  9  8 0.8173897 0.4046348 0.8177976 0.6962180 0.4827957 0.5512421 0.6202447 0.4335929 0.4271413
         V12 Result_mayorvote
1  0.6278828                5
2  0.6278828                5
3  0.8395625                6
4  0.6278828                5
5  0.8154245                4
6  0.6138302                0
7  0.6278828                5
8  0.7583982                7
9  0.7245829                7
10 0.5650723                7
11 0.6278828                5
12 0.8057842                4
13 0.6735261                2
14 0.5400445                0
15 0.7535410                5
16 0.6278828                5
17 0.8055988                4
18 0.6156470                1
19 0.5408231                0
20 0.7116426                6
21 0.6472377                2
22 0.6278828                5
23 0.8055617                4
24 0.6156099                1
25 0.5407861                0
26 0.7116055                6
27 0.6470152                2
28 0.3478680                5
29 0.6278828                5
30 0.8055617                4
31 0.6156099                1
32 0.5408602                0
33 0.7115684                6
34 0.6472747                2
35 0.5854283                5
36 0.6870968                4

$ImportantContrast
[1] 2 5

$FeatureLoading
                 PC2          PC5
carat   0.0191043607 1.373861e-02
color   0.0044075973 9.567310e-02
clarity 0.1921769919 2.493641e-01
depth   0.2631051579 9.024616e-01
table   0.9412235664 3.140789e-01
price   0.0001142357 4.801697e-05
x       0.0611524703 8.327274e-02
y       0.0581850767 9.195955e-02
z       0.0207926278 1.428042e-03

$BestFeatureLoading
            PC2       PC5
table 0.9412236 0.3140789
depth 0.2631052 0.9024616

$BestFeatureNames
[1] "table" "depth"

$PlotUnsupervised

$PlotSupervised

$PlotCombined
TableGrob (1 x 2) "arrange": 2 grobs
  z     cells    name           grob
1 1 (1-1,1-1) arrange gtable[layout]
2 2 (1-1,2-2) arrange gtable[layout]

```

And the resulted images:
[ ![Typical PCA](/docs/RRFE_unsupervised.png)](/docs/RRFE_unsupervised.png)

This image is a typical PCA on the data, showing the loadings as red arrows. Indicative that price dominated the dataset in scale, having 99.~% of the variance in component 1. 

[ ![Optimised  PCA](/docs/RRFE_supervised.png)](/docs/RRFE_unsupervised.png) 

This image is a the supervised contrast on the data, showing the loadings as red arrows. Indicative that table and depth are critically important to "cat". Although the the combined variance is less than 1%, a clear pattern is visible using components 2 & 5.

Take note, the dataset is not scaled (z-normalised). This means every the weight of each feature cannot be compared directly. However, it will indicate the biggest affectors in the data contributing to the class.

If scaling is turned on (s_scale=TRUE), the weigths of features are equal and thus can be compared direcly. However, evaluate if this is a valid assumption that can be made.

[ ![Diamond](/docs/diamond.png)](/docs/diamond.png) 

When evaluating the metrics table and depth it can be seen in the figure above that they are critical measures in the appearance of a diamond, and apparently the size of the (appearing) diamond is most important (who knew!).
